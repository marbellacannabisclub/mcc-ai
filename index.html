<script>
  document.addEventListener("DOMContentLoaded", function() {
    var chatContainer = document.createElement("div");
    chatContainer.style.cssText = "position: fixed; bottom: 20px; right: 20px; z-index: 9999; font-family: sans-serif;";
    chatContainer.innerHTML = `
      <div id="chat-bubble" style="width: 60px; height: 60px; background: #2e7d32; color: #fff; border-radius: 50%; text-align: center; line-height: 60px; cursor: pointer; font-size: 24px; transition: transform 0.3s;">üí¨</div>

      <div id="chat-options" style="display: none; position: absolute; bottom: 70px; right: 0; background: #1a1a1a; padding: 10px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.5); min-width: 200px;">
        <div style="display: flex; flex-direction: column; gap: 10px;">
          <a href="https://wa.me/+34674114748" target="_blank" style="display: flex; align-items: center; background: #2e7d32; color: #fff; padding: 8px; border-radius: 5px; text-decoration: none;">
            <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" style="width: 24px; height: 24px; margin-right: 10px;" alt="WhatsApp"> WhatsApp
          </a>
          <a href="https://t.me/marbellacannabisclub" target="_blank" style="display: flex; align-items: center; background: #2e7d32; color: #fff; padding: 8px; border-radius: 5px; text-decoration: none;">
            <img src="https://upload.wikimedia.org/wikipedia/commons/8/82/Telegram_logo.svg" style="width: 24px; height: 24px; margin-right: 10px;" alt="Telegram"> Telegram
          </a>
          <a href="https://signal.me/#eu/phsh9ufiVBClMu7AvdRvyPeuZ06Qz6DbQAT9ma6Aqr82eBdbWPNBv5HPcp7wtAaV" target="_blank" style="display: flex; align-items: center; background: #2e7d32; color: #fff; padding: 8px; border-radius: 5px; text-decoration: none;">
            <img src="https://upload.wikimedia.org/wikipedia/commons/8/8d/Signal-Logo.svg" style="width: 24px; height: 24px; margin-right: 10px;" alt="Signal"> Signal
          </a>
          <div id="ai-chat-launch" style="display: flex; align-items: center; background: #2e7d32; color: #fff; padding: 8px; border-radius: 5px; cursor: pointer;">
            <img src="https://upload.wikimedia.org/wikipedia/commons/0/04/ChatGPT_logo.svg" style="width: 24px; height: 24px; margin-right: 10px;" alt="AI"> Ask Buddy
          </div>
        </div>
      </div>

      <div id="ai-chat-window" style="display: none; position: fixed; bottom: 90px; right: 20px; width: 320px; height: 420px; background: #ffffff; border-radius: 10px; box-shadow: 0 0 20px rgba(0,0,0,0.3); overflow: visible;">
        <img src="buddy.PNG" alt="Buddy" style="position: absolute; top: -40px; left: -30px; width: 100px; z-index: 10000;">
        <div id="close-chat" style="position: absolute; top: 5px; right: 5px; cursor: pointer; z-index: 10001; font-size: 16px; color: #2e7d32;">‚ùå</div>
        <iframe src="https://marbellacannabisclub.github.io/mcc-chatbot/" width="100%" height="100%" style="border: none;"></iframe>
      </div>
    `;

    document.body.appendChild(chatContainer);

    var bubble = document.getElementById("chat-bubble");
    var aiLauncher = null;
    var aiWindow = null;

    bubble.onmouseover = function() {
      this.style.transform = "scale(1.1)";
    };
    bubble.onmouseout = function() {
      this.style.transform = "scale(1)";
    };
    bubble.onclick = function() {
      var options = document.getElementById("chat-options");
      options.style.display = options.style.display === "none" ? "block" : "none";
    };

    document.addEventListener("click", function(event) {
      if (!chatContainer.contains(event.target)) {
        document.getElementById("chat-options").style.display = "none";
      }
    });

    setTimeout(() => {
      aiLauncher = document.getElementById("ai-chat-launch");
      aiWindow = document.getElementById("ai-chat-window");
      const closeBtn = document.getElementById("close-chat");

      if (aiLauncher) {
        aiLauncher.addEventListener("click", function() {
          aiWindow.style.display = aiWindow.style.display === "none" ? "block" : "none";
        });
      }

      if (closeBtn) {
        closeBtn.addEventListener("click", function() {
          aiWindow.style.display = "none";
        });
      }
    }, 100);

    setTimeout(() => {
      document.getElementById("ai-chat-window").style.display = "block";
    }, 10000);
  });
</script>
